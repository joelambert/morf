/*
 Morf v0.1.5 (pre release)
 http://www.joelambert.co.uk/morf

 Copyright 2011, Joe Lambert.
 Free to use under the MIT license.
 http://www.opensource.org/licenses/mit-license.php
 
 Extra easing functions borrowed from scripty2 (c) 2005-2010 Thomas Fuchs (MIT Licence) 
 https://raw.github.com/madrobby/scripty2/master/src/effects/transitions/transitions.js
*/
var Morf=function(b,g,a){var d={},f={};document.createElement("div");var l=document.createElement("div"),c={timingFunction:"ease",duration:null,increment:0.01,debug:false,optimise:true,decimalPlaces:5},k=rule=ruleName=camel=m1=m2=progress=frame=rule=transEvent=val=null,e="",q=this,r={},t="anim"+(new Date).getTime(),v=function(){b.removeEventListener("webkitAnimationEnd",v,true);transEvent=document.createEvent("Event");transEvent.initEvent("webkitTransitionEnd",true,true);b.dispatchEvent(transEvent);
b.style.webkitTransitionTimingFunction=null;b.style.webkitTransitionDuration=0;c.callback&&c.callback(b)},y=function(n){if(document.styleSheets&&document.styleSheets.length)document.styleSheets[0].insertRule(n,0);else{var o=document.createElement("style");o.innerHTML=n;document.head.appendChild(o)}},z=function(n,o){var h="@-webkit-keyframes "+o+" {\n",s=pos=rule=null,p="";for(pos in n){s=n[pos];p="\t"+pos+" {\n";for(rule in s)p+="\t\t"+q.util.toDash(rule)+": "+s[rule]+";\n";p+="\t}\n\n";h+=p}if(c.optimise){h=
h+" }";s=void 0;s=typeof c.decimalPlaces=="number"?c.decimalPlaces:5;p=h.match(/[0-9\.]+/gm);var u=0;if(p)for(u=0;u<p.length;u++)h=h.replace(p[u],parseFloat(parseFloat(p[u]).toFixed(s)));h=h}else h=h+" }";return h},w=function(n){var o=n.match(/scale[Y|X|Z]*\([0-9, ]*0[,0-9 ]*\)/g),h=0;if(o)for(h=0;h<o.length;h++)n=n.replace(o[h],o[h].replace(/([^0-9])0([^0.9])/g,"$10.0001$2"));return n};for(k in a)c[k]=a[k];if(c.timingFunction==="ease"||c.timingFunction==="linear"||c.timingFunction==="ease-in"||c.timingFunction===
"ease-out"||c.timingFunction==="ease-in-out"||/^cubic-bezier/.test(c.timingFunction)){b.style.webkitTransitionDuration=c.duration;b.style.webkitTransitionTimingFunction=c.timingFunction;var x=function(){b.removeEventListener("webkitTransitionEnd",x,true);b.style.webkitTransitionDuration=0;b.style.webkitTransitionTimingFunction=null;c.callback&&setTimeout(function(){c.callback(b)},10)};b.addEventListener("webkitTransitionEnd",x,true);setTimeout(function(){for(rule in g){camel=q.util.toCamel(rule);
b.style[camel]=g[rule]}},10);this.css=""}else{b.style.webkitTransitionTimingFunction=null;b.style.webkitTransitionDuration=0;e+=c.timingFunction;for(rule in g){camel=this.util.toCamel(rule);l.style[camel]=g[rule];d[rule]=camel=="WebkitTransform"?new WebKitCSSMatrix(w(window.getComputedStyle(b)["-webkit-transform"])):window.getComputedStyle(b)[rule];f[rule]=camel=="WebkitTransform"?new WebKitCSSMatrix(w(l.style.WebkitTransform)):l.style[camel];d[rule]=d[rule]==(val=parseInt(d[rule],10))?val:d[rule];
f[rule]=f[rule]==(val=parseInt(d[rule],10))?val:f[rule];e+=";"+rule+":"+d[rule]+"->"+f[rule]}if(Morf.cache[e]){this.css=Morf.cache[e].css;t=Morf.cache[e].name}else{if(d["-webkit-transform"]){m1=d["-webkit-transform"].decompose();m2=f["-webkit-transform"].decompose()}for(progress=0;progress<=1;progress+=c.increment){frame=Tweenable.util.interpolate(d,f,progress,c.timingFunction);if(m1!==null&&m2!==null)frame["-webkit-transform"]=m1.tween(m2,progress,Tweenable.prototype.formula[c.timingFunction]);r[parseInt(progress*
100,10)+"%"]=frame}r["100%"]=f;this.css=z(r,t);y(this.css);Morf.cache[e]={css:this.css,name:t}}for(rule in f)b.style[this.util.toCamel(rule)]=f[rule];b.addEventListener("webkitAnimationEnd",v,true);b.style.webkitAnimationDuration=c.duration;b.style.webkitAnimationTimingFunction="linear";b.style.webkitAnimationName=t;c.debug&&window.console&&window.console.log&&console.log(this.css)}};Morf.transition=function(b,g,a){return new Morf(b,g,a)};Morf.cache={};Morf.version="0.1.5 (pre release)";
Morf.prototype.util={};Morf.prototype.util.toDash=function(b){b=b.replace(/([A-Z])/g,function(g){return"-"+g.toLowerCase()});return/^webkit/.test(b)?"-"+b:b};Morf.prototype.util.toCamel=function(b){return b.replace(/(\-[a-z])/g,function(g){return g.toUpperCase().replace("-","")})};
(function(){var b=function(a,d,f,l){this.x=a?a:0;this.y=d?d:0;this.z=f?f:0;this.w=l?l:0;this.checkValues=function(){this.x=this.x?this.x:0;this.y=this.y?this.y:0;this.z=this.z?this.z:0;this.w=this.w?this.w:0};this.length=function(){this.checkValues();return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};this.normalise=function(){var c=this.length();return new b(this.x/c,this.y/c,this.z/c)};this.dot=function(c){return this.x*c.x+this.y*c.y+this.z*c.z+this.w*c.w};this.cross=function(c){return new b(this.y*
c.z-this.z*c.y,this.z*c.x-this.x*c.z,this.x*c.y-this.y*c.x)};this.combine=function(c,k,e){return new b(k*this.x+e*c.x,k*this.y+e*c.y,k*this.z+e*c.z)}},g=function(a){a===undefined&&(a={});var d={perspective:null,translate:null,skew:null,scale:null,rotate:null},f;for(f in d)this[f]=a[f]?a[f]:new b;this.tween=function(l,c,k){if(k===undefined)k=function(v){return v};l||(l=new g((new WebKitCSSMatrix).decompose()));var e=new g,q=index=null,r="";c=k(c);for(index in d)for(q in{x:"x",y:"y",z:"z",w:"w"})e[index][q]=
(this[index][q]+(l[index][q]-this[index][q])*c).toFixed(5);r="matrix3d(1,0,0,0, 0,1,0,0, 0,0,1,0, "+e.perspective.x+", "+e.perspective.y+", "+e.perspective.z+", "+e.perspective.w+") translate3d("+e.translate.x+"px, "+e.translate.y+"px, "+e.translate.y+"px) rotateX("+e.rotate.x+"rad) rotateY("+e.rotate.y+"rad) rotateZ("+e.rotate.z+"rad) matrix3d(1,0,0,0, 0,1,0,0, 0,"+e.skew.z+",1,0, 0,0,0,1) matrix3d(1,0,0,0, 0,1,0,0, "+e.skew.y+",0,1,0, 0,0,0,1) matrix3d(1,0,0,0, "+e.skew.x+",1,0,0, 0,0,1,0, 0,0,0,1) scale3d("+
e.scale.x+", "+e.scale.y+", "+e.scale.z+")";try{return e=new WebKitCSSMatrix(r)}catch(t){console.error("Invalid matrix string: "+r);return""}}};WebKitCSSMatrix.prototype.tween=function(a,d,f){if(f===undefined)f=function(k){return k};var l=new WebKitCSSMatrix,c=this.decompose();a=a.decompose();l.decompose();trans="";index=i=null;return c.tween(a,d,f)};WebKitCSSMatrix.prototype.transformVector=function(a){return new b(this.m11*a.x+this.m12*a.y+this.m13*a.z,this.m21*a.x+this.m22*a.y+this.m23*a.z,this.m31*
a.x+this.m32*a.y+this.m33*a.z)};WebKitCSSMatrix.prototype.transpose=function(){var a=new WebKitCSSMatrix,d=m=0;for(d=0;d<=2;d++)for(m=d+1;m<=3;m++){a["m"+(d+1)+(m+1)]=this["m"+(m+1)+(d+1)];a["m"+(m+1)+(d+1)]=this["m"+(d+1)+(m+1)]}return a};WebKitCSSMatrix.prototype.determinant=function(){return this.m14*this.m23*this.m32*this.m41-this.m13*this.m24*this.m32*this.m41-this.m14*this.m22*this.m33*this.m41+this.m12*this.m24*this.m33*this.m41+this.m13*this.m22*this.m34*this.m41-this.m12*this.m23*this.m34*
this.m41-this.m14*this.m23*this.m31*this.m42+this.m13*this.m24*this.m31*this.m42+this.m14*this.m21*this.m33*this.m42-this.m11*this.m24*this.m33*this.m42-this.m13*this.m21*this.m34*this.m42+this.m11*this.m23*this.m34*this.m42+this.m14*this.m22*this.m31*this.m43-this.m12*this.m24*this.m31*this.m43-this.m14*this.m21*this.m32*this.m43+this.m11*this.m24*this.m32*this.m43+this.m12*this.m21*this.m34*this.m43-this.m11*this.m22*this.m34*this.m43-this.m13*this.m22*this.m31*this.m44+this.m12*this.m23*this.m31*
this.m44+this.m13*this.m21*this.m32*this.m44-this.m11*this.m23*this.m32*this.m44-this.m12*this.m21*this.m33*this.m44+this.m11*this.m22*this.m33*this.m44};WebKitCSSMatrix.prototype.decompose=function(){var a=new WebKitCSSMatrix(this.toString()),d=rightHandSide=inversePerspectiveMatrix=transposedInversePerspectiveMatrix=perspective=translate=row=i=scale=skew=pdum3=rotate=null;if(a.m33==0)return new g((new WebKitCSSMatrix).decompose());for(i=1;i<=4;i++)for(j=1;j<=4;j++)a["m"+i+j]/=a.m44;d=a;for(i=1;i<=
3;i++)d["m"+i+"4"]=0;d.m44=1;if(d.determinant()==0)return new g((new WebKitCSSMatrix).decompose());if(a.m14!=0||a.m24!=0||a.m34!=0){rightHandSide=new b(a.m14,a.m24,a.m34,a.m44);inversePerspectiveMatrix=d.inverse();transposedInversePerspectiveMatrix=inversePerspectiveMatrix.transpose();perspective=transposedInversePerspectiveMatrix.transformVector(rightHandSide);a.m14=a.m24=a.m34=0;a.m44=1}else perspective=new b(0,0,0,1);translate=new b(a.m41,a.m42,a.m43);a.m41=0;a.m42=0;a.m43=0;row=[new b,new b,new b];
for(i=1;i<=3;i++){row[i-1].x=a["m"+i+"1"];row[i-1].y=a["m"+i+"2"];row[i-1].z=a["m"+i+"3"]}scale=new b;skew=new b;scale.x=row[0].length();row[0]=row[0].normalise();skew.x=row[0].dot(row[1]);row[1]=row[1].combine(row[0],1,-skew.x);scale.y=row[1].length();row[1]=row[1].normalise();skew.x/=scale.y;skew.y=row[0].dot(row[2]);row[2]=row[2].combine(row[0],1,-skew.y);skew.z=row[1].dot(row[2]);row[2]=row[2].combine(row[1],1,-skew.z);scale.z=row[2].length();row[2]=row[2].normalise();skew.y/=scale.z;skew.y/=
scale.z;pdum3=row[1].cross(row[2]);if(row[0].dot(pdum3)<0)for(i=0;i<3;i++){scale.x*=-1;row[i].x*=-1;row[i].y*=-1;row[i].z*=-1}rotate=new b;rotate.y=Math.asin(-row[0].z);if(Math.cos(rotate.y)!=0){rotate.x=Math.atan2(row[1].z,row[2].z);rotate.z=Math.atan2(row[0].y,row[0].x)}else{rotate.x=Math.atan2(-row[2].x,row[1].y);rotate.z=0}return new g({perspective:perspective,translate:translate,skew:skew,scale:scale,rotate:rotate})}})();
(function(){var b={spring:function(a){return 1-Math.cos(a*4.5*Math.PI)*Math.exp(-a*6)},sinusoidal:function(a){return-Math.cos(a*Math.PI)/2+0.5}},g;for(g in b)Tweenable.prototype.formula[g]=b[g]})();
