/*
 Morf v0.1
 http://www.joelambert.co.uk/morf

 Copyright 2011, Joe Lambert.
 Free to use under the MIT license.
 http://www.opensource.org/licenses/mit-license.php

 Shifty v0.4.1 - A teeny tiny tweening engine in JavaScript. 
 By Jeremy Kahn - jeremyckahn@gmail.com
 For instructions on how to use Shifty, please consult the README: https://github.com/jeremyckahn/tweeny/blob/master/README.md
 MIT Lincense.  This code free to use, modify, distribute and enjoy.
 
 Extra easing functions borrowed from scripty2 (c) 2005-2010 Thomas Fuchs (MIT Licence) 
 https://raw.github.com/madrobby/scripty2/master/src/effects/transitions/transitions.js
*/
var Morf=function(e,a,c){var k={},n={};document.createElement("div");var q=document.createElement("div"),g={timingFunction:"ease",duration:null,increment:0.01,debug:false},p=rule=ruleName=camel=m1=m2=progress=frame=rule=transEvent=null,l=this,o={},b="anim"+(new Date).getTime();animationEndListener=function(){e.removeEventListener("webkitAnimationEnd",animationEndListener,true);transEvent=document.createEvent("Event");transEvent.initEvent("webkitTransitionEnd",true,true);e.dispatchEvent(transEvent);
c.callback&&c.callback()};addKeyframeRule=function(d){if(document.styleSheets&&document.styleSheets.length)document.styleSheets[0].insertRule(d,0);else{var f=document.createElement("style");f.innerHTML=d;document.head.appendChild(f)}};createAnimationCSS=function(d,f){var h="@-webkit-keyframes "+f+" {\n",r=pos=rule=null,s="";for(pos in d){r=d[pos];s="\t"+pos+" {\n";for(rule in r)s+="\t\t"+l.util.toDash(rule)+": "+r[rule]+";\n";s+="\t}\n\n";h+=s}return h+" }"};for(p in c)g[p]=c[p];if(g.timingFunction===
"ease"||g.timingFunction==="linear"||g.timingFunction==="ease-in"||g.timingFunction==="ease-out"||g.timingFunction==="ease-in-out"||/^cubic-bezier/.test(g.timingFunction)){e.style.webkitTransitionDuration=g.duration;e.style.webkitTransitionTimingFunction=g.timingFunction;for(rule in a){camel=this.util.toCamel(rule);e.style[camel]=a[rule]}this.css=""}else{e.style.webkitTransitionTimingFunction=null;e.style.webkitTransitionDuration=0;for(rule in a){camel=this.util.toCamel(rule);q.style[camel]=a[rule];
k[this.util.toDash(camel)]=camel=="WebkitTransform"?new WebKitCSSMatrix(e.style.WebkitTransform):e.style[camel];n[this.util.toDash(camel)]=camel=="WebkitTransform"?new WebKitCSSMatrix(q.style.WebkitTransform):q.style[camel]}if(k["-webkit-transform"]){m1=k["-webkit-transform"].decompose();m2=n["-webkit-transform"].decompose()}for(progress=0;progress<=1;progress+=g.increment){frame=Tweenable.util.interpolate(k,n,progress,g.timingFunction);if(m1!==null&&m2!==null)frame["-webkit-transform"]=m1.tween(m2,
progress,Tweenable.prototype.formula[g.timingFunction]);o[parseInt(progress*100)+"%"]=frame}o["100%"]=n;this.css=createAnimationCSS(o,b);addKeyframeRule(this.css);for(rule in n)e.style[this.util.toCamel(rule)]=n[rule];e.addEventListener("webkitAnimationEnd",animationEndListener,true);e.style.webkitAnimationDuration=g.duration;e.style.webkitAnimationTimingFunction="linear";e.style.webkitAnimationName=b;g.debug&&window.console&&window.console.log&&console.log(createAnimationCSS(o,b))}};
Morf.transition=function(e,a,c){return new Morf(e,a,c)};Morf.version="0.1";Morf.prototype.util={};Morf.prototype.util.toDash=function(e){e=e.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()});return/^webkit/.test(e)?"-"+e:e};Morf.prototype.util.toCamel=function(e){return e.replace(/(\-[a-z])/g,function(a){return a.toUpperCase().replace("-","")})};
(function(){var e=function(c,k,n,q){this.x=c?c:0;this.y=k?k:0;this.z=n?n:0;this.w=q?q:0;this.checkValues=function(){this.x=this.x?this.x:0;this.y=this.y?this.y:0;this.z=this.z?this.z:0;this.w=this.w?this.w:0};this.length=function(){this.checkValues();return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};this.normalise=function(){var g=this.length();return new e(this.x/g,this.y/g,this.z/g)};this.dot=function(g){return this.x*g.x+this.y*g.y+this.z*g.z+this.w*g.w};this.cross=function(g){return new e(this.y*
g.z-this.z*g.y,this.z*g.x-this.x*g.z,this.x*g.y-this.y*g.x)};this.combine=function(g,p,l){return new e(p*this.x+l*g.x,p*this.y+l*g.y,p*this.z+l*g.z)}},a=function(c){c===undefined&&(c={});var k={perspective:null,translate:null,skew:null,scale:null,rotate:null},n;for(n in k)this[n]=c[n]?c[n]:new e;this.tween=function(q,g,p){if(p===undefined)p=function(f){return f};var l=new a,o=index=null,b="";g=p(g);for(index in k)for(o in{x:"x",y:"y",z:"z",w:"w"})l[index][o]=parseFloat((this[index][o]+(q[index][o]-
this[index][o])*g).toFixed(10));b="matrix3d(1,0,0,0, 0,1,0,0, 0,0,1,0, "+l.perspective.x+", "+l.perspective.y+", "+l.perspective.z+", "+l.perspective.w+") translate3d("+l.translate.x+"px, "+l.translate.y+"px, "+l.translate.y+"px) rotateX("+l.rotate.x+"rad) rotateY("+l.rotate.y+"rad) rotateZ("+l.rotate.z+"rad) matrix3d(1,0,0,0, 0,1,0,0, 0,"+l.skew.z+",1,0, 0,0,0,1) matrix3d(1,0,0,0, 0,1,0,0, "+l.skew.y+",0,1,0, 0,0,0,1) matrix3d(1,0,0,0, "+l.skew.x+",1,0,0, 0,0,1,0, 0,0,0,1) scale3d("+l.scale.x+", "+
l.scale.y+", "+l.scale.z+")";try{return l=new WebKitCSSMatrix(b)}catch(d){console.error("Invalid matrix string: "+b);return""}}};WebKitCSSMatrix.prototype.tween=function(c,k,n){if(n===undefined)n=function(p){return p};var q=new WebKitCSSMatrix,g=this.decompose();c=c.decompose();q.decompose();trans="";index=i=null;return g.tween(c,k,n)};WebKitCSSMatrix.prototype.transformVector=function(c){return new e(this.m11*c.x+this.m12*c.y+this.m13*c.z,this.m21*c.x+this.m22*c.y+this.m23*c.z,this.m31*c.x+this.m32*
c.y+this.m33*c.z)};WebKitCSSMatrix.prototype.transpose=function(){var c=new WebKitCSSMatrix,k=m=0;for(k=0;k<=2;k++)for(m=k+1;m<=3;m++){c["m"+(k+1)+(m+1)]=this["m"+(m+1)+(k+1)];c["m"+(m+1)+(k+1)]=this["m"+(k+1)+(m+1)]}return c};WebKitCSSMatrix.prototype.determinant=function(){return this.m14*this.m23*this.m32*this.m41-this.m13*this.m24*this.m32*this.m41-this.m14*this.m22*this.m33*this.m41+this.m12*this.m24*this.m33*this.m41+this.m13*this.m22*this.m34*this.m41-this.m12*this.m23*this.m34*this.m41-this.m14*
this.m23*this.m31*this.m42+this.m13*this.m24*this.m31*this.m42+this.m14*this.m21*this.m33*this.m42-this.m11*this.m24*this.m33*this.m42-this.m13*this.m21*this.m34*this.m42+this.m11*this.m23*this.m34*this.m42+this.m14*this.m22*this.m31*this.m43-this.m12*this.m24*this.m31*this.m43-this.m14*this.m21*this.m32*this.m43+this.m11*this.m24*this.m32*this.m43+this.m12*this.m21*this.m34*this.m43-this.m11*this.m22*this.m34*this.m43-this.m13*this.m22*this.m31*this.m44+this.m12*this.m23*this.m31*this.m44+this.m13*
this.m21*this.m32*this.m44-this.m11*this.m23*this.m32*this.m44-this.m12*this.m21*this.m33*this.m44+this.m11*this.m22*this.m33*this.m44};WebKitCSSMatrix.prototype.decompose=function(){var c=new WebKitCSSMatrix(this.toString()),k=rightHandSide=inversePerspectiveMatrix=transposedInversePerspectiveMatrix=perspective=translate=row=i=scale=skew=pdum3=rotate=null;if(c.m33==0)return false;for(i=1;i<=4;i++)for(j=1;j<=4;j++)c["m"+i+j]/=c.m44;k=c;for(i=1;i<=3;i++)k["m"+i+"4"]=0;k.m44=1;if(k.determinant()==0)return false;
if(c.m14!=0||c.m24!=0||c.m34!=0){rightHandSide=new e(c.m14,c.m24,c.m34,c.m44);inversePerspectiveMatrix=k.inverse();transposedInversePerspectiveMatrix=inversePerspectiveMatrix.transpose();perspective=transposedInversePerspectiveMatrix.transformVector(rightHandSide);c.m14=c.m24=c.m34=0;c.m44=1}else perspective=new e(0,0,0,1);translate=new e(c.m41,c.m42,c.m43);c.m41=0;c.m42=0;c.m43=0;row=[new e,new e,new e];for(i=1;i<=3;i++){row[i-1].x=c["m"+i+"1"];row[i-1].y=c["m"+i+"2"];row[i-1].z=c["m"+i+"3"]}scale=
new e;skew=new e;scale.x=row[0].length();row[0]=row[0].normalise();skew.x=row[0].dot(row[1]);row[1]=row[1].combine(row[0],1,-skew.x);scale.y=row[1].length();row[1]=row[1].normalise();skew.x/=scale.y;skew.y=row[0].dot(row[2]);row[2]=row[2].combine(row[0],1,-skew.y);skew.z=row[1].dot(row[2]);row[2]=row[2].combine(row[1],1,-skew.z);scale.z=row[2].length();row[2]=row[2].normalise();skew.y/=scale.z;skew.y/=scale.z;pdum3=row[1].cross(row[2]);if(row[0].dot(pdum3)<0)for(i=0;i<3;i++){scale.x*=-1;row[i].x*=
-1;row[i].y*=-1;row[i].z*=-1}rotate=new e;rotate.y=Math.asin(-row[0].z);if(Math.cos(rotate.y)!=0){rotate.x=Math.atan2(row[1].z,row[2].z);rotate.z=Math.atan2(row[0].y,row[0].x)}else{rotate.x=Math.atan2(-row[2].x,row[1].y);rotate.z=0}return new a({perspective:perspective,translate:translate,skew:skew,scale:scale,rotate:rotate})}})();
(function(e){function a(){return+new Date}function c(b,d){for(var f in b)b.hasOwnProperty(f)&&d(b,f)}function k(b,d){c(d,function(f,h){b[h]=f[h]});return b}function n(b,d){c(d,function(f,h){typeof b[h]==="undefined"&&(b[h]=f[h])});return b}function q(b,d,f){var h;b=(b-d.timestamp)/d.duration;for(h in f.current)f.current.hasOwnProperty(h)&&d.to.hasOwnProperty(h)&&(f.current[h]=d.originalState[h]+(d.to[h]-d.originalState[h])*d.easingFunc(b));return f.current}function g(b,d,f,h){var r;for(r=0;r<d[b].length;r++)d[b][r].apply(f,
h)}function p(b,d,f){c(e.Tweenable.prototype.filter,function(h,r){h[r][b]&&h[r][b].apply(d,f)})}function l(b,d){var f;f=a();f<b.timestamp+b.duration&&d.isAnimating?(p("beforeTween",b.owner,[d.current,b.originalState,b.to]),q(f,b,d),p("afterTween",b.owner,[d.current,b.originalState,b.to]),b.hook.step&&g("step",b.hook,b.owner,[d.current]),b.step.call(d.current),d.loopId=setTimeout(function(){l(b,d)},1E3/b.owner.fps)):b.owner.stop(true)}function o(b){b=b||{};this._hook={};this._tweenParams={owner:this,
hook:this._hook};this._state={};this._state.current=b.initialState||{};this.fps=b.fps||30;this.easing=b.easing||"linear";this.duration=b.duration||500;return this}o.prototype.tween=function(b,d,f,h,r){var s=this;if(!this._state.isAnimating)return this._state.loopId=0,this._state.pausedAtTime=null,d?(this._tweenParams.step=function(){},this._state.current=b||{},this._tweenParams.to=d||{},this._tweenParams.duration=f||this.duration,this._tweenParams.callback=h||function(){},this._tweenParams.easing=
r||this.easing):(this._tweenParams.step=b.step||function(){},this._tweenParams.callback=b.callback||function(){},this._state.current=b.from||{},this._tweenParams.to=b.to||b.target||{},this._tweenParams.duration=b.duration||this.duration,this._tweenParams.easing=b.easing||this.easing),this._tweenParams.timestamp=a(),this._tweenParams.easingFunc=this.formula[this._tweenParams.easing]||this.formula.linear,n(this._state.current,this._tweenParams.to),n(this._tweenParams.to,this._state.current),p("tweenCreated",
this._tweenParams.owner,[this._state.current,this._tweenParams.originalState,this._tweenParams.to]),this._tweenParams.originalState=k({},this._state.current),this._state.isAnimating=true,setTimeout(function(){l(s._tweenParams,s._state)},1E3/this.fps),this};o.prototype.to=function(b,d,f,h){typeof d==="undefined"?(b.from=this.get(),this.tween(b)):this.tween(this.get(),b,d,f,h);return this};o.prototype.get=function(){return this._state.current};o.prototype.set=function(b){this._state.current=b||{};return this};
o.prototype.stop=function(b){clearTimeout(this._state.loopId);this._state.isAnimating=false;b&&(k(this._state.current,this._tweenParams.to),this._tweenParams.callback.call(this._state.current));return this};o.prototype.pause=function(){clearTimeout(this._state.loopId);this._state.pausedAtTime=a();this._state.isPaused=true;return this};o.prototype.resume=function(){var b=this;this._state.isPaused&&(this._tweenParams.timestamp+=this._state.pausedAtTime-this._tweenParams.timestamp);setTimeout(function(){l(b._tweenParams,
b._state)},1E3/this.fps);return this};o.prototype.hookAdd=function(b,d){this._hook.hasOwnProperty(b)||(this._hook[b]=[]);this._hook[b].push(d)};o.prototype.hookRemove=function(b,d){var f;if(this._hook.hasOwnProperty(b))if(d)for(f=this._hook[b].length;f>=0;f++)this._hook[b][f]===d&&this._hook[b].splice(f,1);else this._hook[b]=[]};o.prototype.filter={};o.util={now:a,each:c,tweenProps:q,applyFilter:p,simpleCopy:k};o.prototype.formula={linear:function(b){return b}};e.Tweenable=o})(this);
(function(e){e.Tweenable.util.simpleCopy(e.Tweenable.prototype.formula,{easeInQuad:function(a){return Math.pow(a,2)},easeOutQuad:function(a){return-(Math.pow(a-1,2)-1)},easeInOutQuad:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,2);return-0.5*((a-=2)*a-2)},easeInCubic:function(a){return Math.pow(a,3)},easeOutCubic:function(a){return Math.pow(a-1,3)+1},easeInOutCubic:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,3);return 0.5*(Math.pow(a-2,3)+2)},easeInQuart:function(a){return Math.pow(a,4)},easeOutQuart:function(a){return-(Math.pow(a-
1,4)-1)},easeInOutQuart:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,4);return-0.5*((a-=2)*Math.pow(a,3)-2)},easeInQuint:function(a){return Math.pow(a,5)},easeOutQuint:function(a){return Math.pow(a-1,5)+1},easeInOutQuint:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,5);return 0.5*(Math.pow(a-2,5)+2)},easeInSine:function(a){return-Math.cos(a*(Math.PI/2))+1},easeOutSine:function(a){return Math.sin(a*(Math.PI/2))},easeInOutSine:function(a){return-0.5*(Math.cos(Math.PI*a)-1)},easeInExpo:function(a){return a==
0?0:Math.pow(2,10*(a-1))},easeOutExpo:function(a){return a==1?1:-Math.pow(2,-10*a)+1},easeInOutExpo:function(a){if(a==0)return 0;if(a==1)return 1;if((a/=0.5)<1)return 0.5*Math.pow(2,10*(a-1));return 0.5*(-Math.pow(2,-10*--a)+2)},easeInCirc:function(a){return-(Math.sqrt(1-a*a)-1)},easeOutCirc:function(a){return Math.sqrt(1-Math.pow(a-1,2))},easeInOutCirc:function(a){if((a/=0.5)<1)return-0.5*(Math.sqrt(1-a*a)-1);return 0.5*(Math.sqrt(1-(a-=2)*a)+1)},easeOutBounce:function(a){return a<1/2.75?7.5625*
a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},easeInBack:function(a){return a*a*(2.70158*a-1.70158)},easeOutBack:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},easeInOutBack:function(a){var c=1.70158;if((a/=0.5)<1)return 0.5*a*a*(((c*=1.525)+1)*a-c);return 0.5*((a-=2)*a*(((c*=1.525)+1)*a+c)+2)},elastic:function(a){return-1*Math.pow(4,-8*a)*Math.sin((a*6-1)*2*Math.PI/2)+1},swingFromTo:function(a){var c=1.70158;return(a/=0.5)<
1?0.5*a*a*(((c*=1.525)+1)*a-c):0.5*((a-=2)*a*(((c*=1.525)+1)*a+c)+2)},swingFrom:function(a){return a*a*(2.70158*a-1.70158)},swingTo:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},bounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},bouncePast:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?2-(7.5625*(a-=1.5/2.75)*a+0.75):a<2.5/2.75?2-(7.5625*(a-=2.25/2.75)*a+0.9375):2-(7.5625*(a-=2.625/2.75)*
a+0.984375)},easeFromTo:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,4);return-0.5*((a-=2)*Math.pow(a,3)-2)},easeFrom:function(a){return Math.pow(a,4)},easeTo:function(a){return Math.pow(a,0.25)}})})(this);
(function(e){function a(k,n){return function(){k();n.shift();if(n.length)n[0]();else n.running=false}}function c(k,n,q,g,p,l){return function(){q?k.tween(n,q,g,p,l):(n.callback=p,n.from?k.tween(n):k.to(n))}}e.Tweenable.prototype.queue=function(k,n,q,g,p){if(!this._tweenQueue)this._tweenQueue=[];g=g||k.callback||function(){};g=a(g,this._tweenQueue);this._tweenQueue.push(c(this,k,n,q,g,p));if(!this._tweenQueue.running){this._tweenQueue[0]();this._tweenQueue.running=true}return this};e.Tweenable.prototype.queueShift=
function(){this._tweenQueue.shift();return this};e.Tweenable.prototype.queuePop=function(){this._tweenQueue.pop();return this};e.Tweenable.prototype.queueEmpty=function(){this._tweenQueue.length=0;return this};e.Tweenable.prototype.queueLength=function(){return this._tweenQueue.length}})(this);
(function(e){function a(b){return parseInt(b,16)}function c(b){e.Tweenable.util.each(b,function(d,f){if(typeof d[f]==="string"&&(g.test(d[f])||p.test(d[f]))){var h;h=d[f];h=h.replace(/#/g,"");h.length===3&&(h=h.split(""),h=h[0]+h[0]+h[1]+h[1]+h[2]+h[2]);h=[a(h.substr(0,2)),a(h.substr(2,2)),a(h.substr(4,2))];d[f]="rgb("+h[0]+","+h[1]+","+h[2]+")"}})}function k(b){var d;d=[];e.Tweenable.util.each(b,function(f,h){typeof f[h]==="string"&&(g.test(f[h])||p.test(f[h])||l.test(f[h]))&&d.push(h)});return d}
function n(b,d){var f,h,r;h=d.length;for(f=0;f<h;f++){r=b[d[f]].match(/(\d+)/g);b["__r__"+d[f]]=+r[0];b["__g__"+d[f]]=+r[1];b["__b__"+d[f]]=+r[2];delete b[d[f]]}}function q(b,d){var f,h;h=d.length;for(f=0;f<h;f++){b[d[f]]="rgb("+parseInt(b["__r__"+d[f]],10)+","+parseInt(b["__g__"+d[f]],10)+","+parseInt(b["__b__"+d[f]],10)+")";delete b["__r__"+d[f]];delete b["__g__"+d[f]];delete b["__b__"+d[f]]}}var g=/^#([0-9]|[a-f]){3}$/i,p=/^#([0-9]|[a-f]){6}$/i,l=/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)\s*$/i,o;
if(e.Tweenable)e.Tweenable.prototype.filter.color={tweenCreated:function(b,d,f){c(b);c(d);c(f)},beforeTween:function(b,d,f){o=k(d);n(b,o);n(d,o);n(f,o)},afterTween:function(b,d,f){q(b,o);q(d,o);q(f,o)}}})(this);
(function(e){function a(p){var l;l={};e.Tweenable.util.each(p,function(o,b){typeof o[b]==="string"&&n.test(o[b])&&(l[b]={suffix:o[b].match(n)[0]})});return l}function c(p,l){e.Tweenable.util.each(l,function(o,b){p[b]=+p[b].replace(q,"")})}function k(p,l){e.Tweenable.util.each(l,function(o,b){p[b]+=o[b].suffix})}var n=/(px|em|%|pc|pt|mm|cm|in|ex)/i,q=/([a-z]|%)/gi,g;e.Tweenable.prototype.filter.token={beforeTween:function(p,l,o){g=a(l);c(p,g);c(l,g);c(o,g)},afterTween:function(p,l,o){k(p,g);k(l,g);
k(o,g)}}})(this);
(function(e){if(e.Tweenable){e.Tweenable.util.interpolate=function(a,c,k,n){var q;if(a&&a.from){c=a.to;k=a.position;n=a.easing;a=a.from}q=e.Tweenable.util.simpleCopy({},a);e.Tweenable.util.applyFilter("tweenCreated",q,[q,a,c]);e.Tweenable.util.applyFilter("beforeTween",q,[q,a,c]);k=e.Tweenable.util.tweenProps(k,{originalState:a,to:c,timestamp:0,duration:1,easingFunc:e.Tweenable.prototype.formula[n]||e.Tweenable.prototype.formula.linear},{current:q});e.Tweenable.util.applyFilter("afterTween",k,[k,
a,c]);return k};e.Tweenable.prototype.interpolate=function(a,c,k){a=e.Tweenable.util.interpolate(this.get(),a,c,k);this.set(a);return a}}})(this);(function(){var e={spring:function(c){return 1-Math.cos(c*4.5*Math.PI)*Math.exp(-c*6)},sinusoidal:function(c){return-Math.cos(c*Math.PI)/2+0.5}},a;for(a in e)Tweenable.prototype.formula[a]=e[a]})();
